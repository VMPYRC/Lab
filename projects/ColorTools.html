<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../assets/css/global.css" />
    <link rel="icon" href="../assets/images/favicon.ico" />
    <meta name="author" content="VMPYRC" />
    <title>Color Tools</title>
    <style>
      .card {
        background: #000000;
        border-radius: 10px;
        border: 1px solid #ffffff;
        margin-bottom: 10px;
        padding: 10px;
      }
      .color-box {
        border-radius: 10px;
        border: 1px solid #ffffff;
        cursor: pointer;
        height: 100px;
        width: 100px;
      }
      .color-viewers {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
      }
      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 5px;
      }
      #importBox {
        background: transparent;
        border-radius: 10px;
        border: 1px solid #ffffff;
        color: inherit;
        min-height: 80px;
        padding: 5px;
        width: 80%;
      }
      input[type="color"] {
        background: transparent;
        border-radius: 10px;
        border: 0;
        border: 1px solid #ffffff;
        height: 50px;
        padding: 0;
        width: 50px;
      }
      input[type="text"] {
        background: transparent;
        border-radius: 10px;
        border: 1px solid #ffffff;
        color: inherit;
        padding: 5px;
        width: 90px;
      }
      .palette {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
      }
      .notification {
        border-radius: 10px;
        border: 1px solid #ffffff;
        font-size: 20px;
        font-weight: 600;
        left: 50%;
        opacity: 0;
        padding: 10px;
        pointer-events: none;
        position: fixed;
        top: 20px;
        transform: translateX(-50%);
        transition: opacity 0.3s, transform 0.3s;
        z-index: 1000;
      }
      .notification.show {
        opacity: 1;
        transform: translateX(-50%) translateY(10px);
      }
      .notification.success {
        background: #00ff00;
        color: #000000;
      }
      .notification.warning {
        background: #ffff00;
        color: #000000;
      }
      .notification.error {
        background: #ff0000;
        color: #ffffff;
      }
      .swatch {
        align-items: center;
        border-radius: 10px;
        color: #000000;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        font-weight: 700;
        height: 100px;
        justify-content: center;
        position: relative;
        user-select: none;
        width: 100px;
      }
      .swatch small {
        border-radius: 10px;
        color: #ffffff;
        padding: 5px;
      }
      .viewer {
        align-items: flex-start;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }
      .viewer + .viewer {
        margin-left: -5px;
      }
      .wrap {
        margin: 0 auto;
        max-width: 900px;
      }
    </style>
  </head>
  <body>
    <h1><a href="../index.html">VMPYRC'S LAB</a> - Color Tools</h1>
    <hr />

    <div class="wrap">
      <div class="card">
        <h2>Palette Builder</h2>
        <div class="controls">
          <p>Text input</p>
          <input id="hexInput" type="text" placeholder="#ffffff" value="#ffffff" />
          <p>Color picker</p>
          <input id="colorPicker" type="color" value="#ffffff" />
          <button id="addBtn">Add to Palette</button>
        </div>

        <div class="controls">
          <p>Import Box</p>
          <table>
            <thead>
              <tr>
                <th style="text-align: center">Input</th>
                <th style="text-align: center">Color</th>
                <th style="text-align: left">Note</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align: center">#FFFFFF 000000</td>
                <td style="text-align: center">#White Black</td>
                <td style="text-align: left">with # and without #</td>
              </tr>
              <tr>
                <td style="text-align: center">#999 555</td>
                <td style="text-align: center">#Grey Grey</td>
                <td style="text-align: left">short hex - with # and without #</td>
              </tr>
              <tr>
                <td style="text-align: center">#FF000055</td>
                <td style="text-align: center">#Red</td>
                <td style="text-align: left">input RGBA, outputs without opacity/transparency</td>
              </tr>
              <tr>
                <td style="text-align: center">FF5500, FFFF00<br />00FF00</td>
                <td style="text-align: center">Orange, Yellow<br />Green</td>
                <td style="text-align: left">comma separated values<br />multi-line values</td>
              </tr>
              <tr>
                <td style="text-align: center">00FFFF#0000FF<br />9900FFFF0080</td>
                <td style="text-align: center">Cyan#Blue<br />PurplePink</td>
                <td style="text-align: left">combined values - with # and without #</td>
              </tr>
            </tbody>
          </table>
          <textarea id="importBox" placeholder="ffffff, #000000"></textarea>
          <button id="importText">Import Colors</button>
        </div>

        <p>
          Palette<br />
          - Left-click a swatch to copy its HEX code.<br />
          - Right-click a swatch to remove it from the palette.
        </p>
        <div id="palette" class="palette"></div>
        <button id="clearBtn" class="ghost">Clear Palette</button>
      </div>

      <div class="card">
        <h2>Convert ARGB to Hex</h2>
        <p>
          Replaces 0xFF with #<br />
          Examples:<br />
          - 0xFFFFFFFF = #FFFFFF = White<br />
          - 0xFF000000 = #000000 = Black<br />
          - 0xFFFF0080 = #FF0080 = Neon Rose (Pink)<br />
          - 0xFF00FFFF = #00FFFF = Cyan (Blue)
        </p>

        <div class="color-viewers">
          <div class="viewer">
            <label for="hex-input-1">ARGB:</label>
            <input type="text" id="hex-input-1" placeholder="0xFFFFFFFF" oninput="autoPreviewColor('hex-input-1', 'color-box-1')" />
            <div class="color-box" id="color-box-1" onclick="copyColorFromBox('hex-input-1')"></div>
          </div>

          <div class="viewer">
            <label for="hex-input-2">ARGB:</label>
            <input type="text" id="hex-input-2" placeholder="0xFFFFFFFF" oninput="autoPreviewColor('hex-input-2', 'color-box-2')" />
            <div class="color-box" id="color-box-2" onclick="copyColorFromBox('hex-input-2')"></div>
          </div>

          <div class="viewer">
            <label for="hex-input-3">ARGB:</label>
            <input type="text" id="hex-input-3" placeholder="0xFFFFFFFF" oninput="autoPreviewColor('hex-input-3', 'color-box-3')" />
            <div class="color-box" id="color-box-3" onclick="copyColorFromBox('hex-input-3')"></div>
          </div>

          <div class="viewer">
            <label for="hex-input-4">ARGB:</label>
            <input type="text" id="hex-input-4" placeholder="0xFFFFFFFF" oninput="autoPreviewColor('hex-input-4', 'color-box-4')" />
            <div class="color-box" id="color-box-4" onclick="copyColorFromBox('hex-input-4')"></div>
          </div>
        </div>
        <p>Left-click a swatch to copy its HEX color equivalent.</p>
      </div>
    </div>

    <div id="notification" class="notification"></div>
    <hr />
  </body>
  <script>
    const $ = (sel) => document.querySelector(sel);
    const paletteEl = $("#palette");
    const hexInput = $("#hexInput");
    const colorPicker = $("#colorPicker");
    const addBtn = $("#addBtn");
    const clearBtn = $("#clearBtn");
    const importBox = $("#importBox");
    const importText = $("#importText");
    const notification = $("#notification");

    let current = [];

    function showNotification(msg, type = "success") {
      notification.textContent = msg;
      notification.className = `notification show ${type}`;
      setTimeout(() => notification.classList.remove("show"), 2500);
    }

    function normalizeHex(h) {
      if (!h) return null;
      h = h.trim().toLowerCase();
      if (h[0] === "#") h = h.slice(1);
      if (h.length === 3)
        h = h
          .split("")
          .map((c) => c + c)
          .join("");
      if (!/^([0-9a-f]{6})$/.test(h)) return null;
      return "#" + h.toUpperCase();
    }

    function luminance(hex) {
      hex = normalizeHex(hex);
      if (!hex) return 0;
      const r = parseInt(hex.slice(1, 3), 16) / 255;
      const g = parseInt(hex.slice(3, 5), 16) / 255;
      const b = parseInt(hex.slice(5, 7), 16) / 255;
      const srgb = [r, g, b].map((c) => (c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4)));
      return 0.2126 * srgb[0] + 0.7152 * srgb[1] + 0.0722 * srgb[2];
    }

    function readableTextColor(hex) {
      return luminance(hex) > 0.5 ? "#000" : "#fff";
    }

    function renderPalette() {
      paletteEl.innerHTML = "";
      current.forEach((hex, idx) => {
        const sw = document.createElement("div");
        sw.className = "swatch";
        sw.style.background = hex;
        const small = document.createElement("small");
        small.textContent = hex;
        small.style.color = readableTextColor(hex);
        sw.appendChild(small);
        sw.onclick = () => {
          navigator.clipboard.writeText(hex);
          showNotification(`Copied ${hex}!`, "success");
        };
        sw.oncontextmenu = (e) => {
          e.preventDefault();
          current.splice(idx, 1);
          renderPalette();
          showNotification(`Removed ${hex}`, "warning");
        };
        paletteEl.appendChild(sw);
      });
    }

    function addColor(hex) {
      if (!hex) return;
      if (current.includes(hex)) return showNotification("Color already in palette!", "warning");
      current.push(hex);
      renderPalette();
      showNotification(`Added ${hex}`, "success");
    }

    addBtn.onclick = () => {
      const hx = normalizeHex(hexInput.value || colorPicker.value);
      if (!hx) {
        showNotification("Enter a valid hex", "error");
        return;
      }
      addColor(hx);
    };

    colorPicker.oninput = (e) => {
      hexInput.value = e.target.value;
    };
    clearBtn.onclick = () => {
      current = [];
      renderPalette();
      showNotification("Palette cleared", "warning");
    };

    importText.onclick = () => {
      const txt = importBox.value;
      if (!txt) return showNotification("Empty! Add some colors.", "error");
      const matches = txt.match(/#?[0-9a-fA-F]{3,6}/g);
      if (!matches) {
        showNotification("Invalid hex color code", "error");
        return;
      }
      const parsed = matches.map(normalizeHex).filter(Boolean);
      parsed.forEach((c) => {
        if (!current.includes(c)) current.push(c);
      });
      renderPalette();
      showNotification("Imported colors", "success");
    };

    function autoPreviewColor(inputId, boxId) {
      const hexInput = document.getElementById(inputId).value.trim();
      if (!/^0x[a-fA-F0-9]{8}$/.test(hexInput)) {
        document.getElementById(boxId).style.backgroundColor = "white";
        return;
      }
      const argb = parseInt(hexInput, 16);
      const alpha = (argb >> 24) & 0xff;
      const red = (argb >> 16) & 0xff;
      const green = (argb >> 8) & 0xff;
      const blue = argb & 0xff;
      const rgbaColor = `rgba(${red}, ${green}, ${blue}, ${alpha / 255})`;
      document.getElementById(boxId).style.backgroundColor = rgbaColor;
    }

    function copyColorFromBox(inputId) {
      const val = document.getElementById(inputId).value.trim();
      if (!/^0x[a-fA-F0-9]{8}$/.test(val)) return showNotification("Invalid ARGB format", "error");
      const argb = parseInt(val, 16);
      const red = (argb >> 16) & 0xff;
      const green = (argb >> 8) & 0xff;
      const blue = argb & 0xff;
      const hex = `#${[red, green, blue].map((x) => x.toString(16).padStart(2, "0")).join("")}`.toUpperCase();
      navigator.clipboard.writeText(hex);
      showNotification(`Copied ${hex}`, "success");
    }
  </script>
</html>
